{"version":3,"sources":["../src/mode-stackdriver.js"],"names":["ace","define","require","exports","module","oop","TextHighlightRules","StackdriverHighlightRules","keywords","builtinConstants","builtinFunctions","keywordMapper","createKeywordMapper","$rules","token","regex","normalizeRules","inherits","lang","stackdriverKeyWords","keyWordsCompletions","map","word","caption","value","meta","score","Number","MAX_VALUE","wrapText","str","len","lines","space_index","line_start","next_line_end","line","i","length","slice","push","join","convertMarkDownTags","text","replace","convertToHTML","item","docText","escapeHTML","def","StackdriverCompletions","getCompletions","state","session","pos","prefix","callback","getTokenAt","row","column","type","completions","call","prototype","Behaviour","CstyleBehaviour","TokenIterator","getWrapped","selection","selected","opening","closing","rowDiff","end","start","StackdriverBehaviour","inherit","TextMode","Mode","HighlightRules","$behaviour","$completer","completer","$id"],"mappings":"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","file":"mode-stackdriver.js","sourcesContent":["// jshint ignore: start\n// jscs: disable\nace.define(\"ace/mode/stackdriver_highlight_rules\",[\"require\",\"exports\",\"module\",\"ace/lib/oop\",\"ace/mode/text_highlight_rules\"], function(require, exports, module) {\n\"use strict\";\n\nvar oop = require(\"../lib/oop\");\nvar TextHighlightRules = require(\"./text_highlight_rules\").TextHighlightRules;\n\nvar StackdriverHighlightRules = function() {\n  var keywords = (\n    \"AND|OR|NOT\"\n  );\n\n  var builtinConstants = (\n    \"true|false\"\n  );\n\n  var builtinFunctions = (\n    \"starts_with|ends_with|has_substring|one_of\"\n  );\n\n  var keywordMapper = this.createKeywordMapper({\n    \"support.function\": builtinFunctions,\n    \"keyword\": keywords,\n    \"constant.language\": builtinConstants\n  }, \"identifier\", true);\n\n  this.$rules = {\n    \"start\" : [ {\n      token: \"string.quoted\",\n      regex: '\"[^\"]*\"'\n    }, {\n      token : \"string\", // single line\n      regex : /\"(?:[^\"\\\\]|\\\\.)*?\"/\n    }, {\n      token : \"string\", // string\n      regex : \"'.*?'\"\n    }, {\n      token : \"constant.numeric\", // float\n      regex : \"[-]?\\\\d+(?:(?:\\\\.\\\\d*)?(?:[eE][+-]?\\\\d+)?)?\\\\b\"\n    }, {\n      token : keywordMapper,\n      regex : \"[a-zA-Z][a-zA-Z_\\\\.]*\\\\b\"\n    }, {\n      token : \"keyword.operator\",\n      regex : \":|>=|<=|>|<|!=|=\"\n    }, {\n      token : \"paren.lparen\",\n      regex : \"[(]\"\n    }, {\n      token : \"paren.rparen\",\n      regex : \"[)]\"\n    }, {\n      token : \"text\",\n      regex : \"\\\\s+\"\n    } ]\n  };\n\n  this.normalizeRules();\n};\n\noop.inherits(StackdriverHighlightRules, TextHighlightRules);\n\nexports.StackdriverHighlightRules = StackdriverHighlightRules;\n});\n\nace.define(\"ace/mode/stackdriver_completions\",[\"require\",\"exports\",\"module\",\"ace/token_iterator\", \"ace/lib/lang\"], function(require, exports, module) {\n\"use strict\";\n\nvar lang = require(\"../lib/lang\");\n\nvar stackdriverKeyWords = [\n  'starts_with', 'ends_with', 'has_substring', 'one_of', 'AND', 'OR', 'NOT'\n];\n\nvar keyWordsCompletions = stackdriverKeyWords.map(function(word) {\n  return {\n    caption: word,\n    value: word,\n    meta: \"keyword\",\n    score: Number.MAX_VALUE\n  }\n});\n\nfunction wrapText(str, len) {\n  len = len || 60;\n  var lines = [];\n  var space_index = 0;\n  var line_start = 0;\n  var next_line_end = len;\n  var line = \"\";\n  for (var i = 0; i < str.length; i++) {\n    if (str[i] === ' ') {\n      space_index = i;\n    } else if (i >= next_line_end && space_index != 0) {\n      line = str.slice(line_start, space_index);\n      lines.push(line);\n      line_start = space_index + 1;\n      next_line_end = i + len;\n      space_index = 0;\n    }\n  }\n  line = str.slice(line_start);\n  lines.push(line);\n  return lines.join(\"&nbsp<br>\");\n}\n\nfunction convertMarkDownTags(text) {\n  text = text.replace(/```(.+)```/, \"<pre>$1</pre>\");\n  text = text.replace(/`([^`]+)`/, \"<code>$1</code>\");\n  return text;\n}\n\nfunction convertToHTML(item) {\n  var docText = lang.escapeHTML(item.docText);\n  docText = convertMarkDownTags(wrapText(docText, 40));\n  return [\n    \"<b>\", lang.escapeHTML(item.def), \"</b>\", \"<hr></hr>\", docText, \"<br>&nbsp\"\n  ].join(\"\");\n}\n\nvar StackdriverCompletions = function() {};\n\n(function() {\n  this.getCompletions = function(state, session, pos, prefix, callback) {\n    var token = session.getTokenAt(pos.row, pos.column);\n    if (token.type === 'identifier' || token.type === 'string.quoted') {\n      return callback(null, []);\n    }\n\n    var completions = keyWordsCompletions;\n    callback(null, completions);\n  };\n\n}).call(StackdriverCompletions.prototype);\n\nexports.StackdriverCompletions = StackdriverCompletions;\n});\n\nace.define(\"ace/mode/behaviour/stackdriver\",[\"require\",\"exports\",\"module\",\"ace/lib/oop\",\"ace/mode/behaviour\",\"ace/mode/behaviour/cstyle\",\"ace/token_iterator\"], function(require, exports, module) {\n\"use strict\";\n\nvar oop = require(\"../../lib/oop\");\nvar Behaviour = require(\"../behaviour\").Behaviour;\nvar CstyleBehaviour = require(\"./cstyle\").CstyleBehaviour;\nvar TokenIterator = require(\"../../token_iterator\").TokenIterator;\n\nfunction getWrapped(selection, selected, opening, closing) {\n  var rowDiff = selection.end.row - selection.start.row;\n  return {\n    text: opening + selected + closing,\n    selection: [\n      0,\n      selection.start.column + 1,\n      rowDiff,\n      selection.end.column + (rowDiff ? 0 : 1)\n    ]\n  };\n};\n\nvar StackdriverBehaviour = function () {\n  this.inherit(CstyleBehaviour);\n}\noop.inherits(StackdriverBehaviour, CstyleBehaviour);\n\nexports.StackdriverBehaviour = StackdriverBehaviour;\n});\n\nace.define(\"ace/mode/stackdriver\",[\"require\",\"exports\",\"module\",\"ace/lib/oop\",\"ace/mode/text\",\"ace/mode/stackdriver_highlight_rules\"], function(require, exports, module) {\n\"use strict\";\n\nvar oop = require(\"../lib/oop\");\nvar TextMode = require(\"./text\").Mode;\nvar StackdriverHighlightRules = require(\"./stackdriver_highlight_rules\").StackdriverHighlightRules;\nvar StackdriverCompletions = require(\"./stackdriver_completions\").StackdriverCompletions;\nvar StackdriverBehaviour = require(\"./behaviour/stackdriver\").StackdriverBehaviour;\n\nvar Mode = function() {\n  this.HighlightRules = StackdriverHighlightRules;\n  this.$behaviour = new StackdriverBehaviour();\n  this.$completer = new StackdriverCompletions();\n  // replace keyWordCompleter\n  this.completer = this.$completer;\n};\noop.inherits(Mode, TextMode);\n\n(function() {\n\n  this.$id = \"ace/mode/stackdriver\";\n}).call(Mode.prototype);\n\nexports.Mode = Mode;\n\n});\n"]}